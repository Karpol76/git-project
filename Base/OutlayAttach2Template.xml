<?xml version="1.0" encoding="utf-8" ?>
<document caption="Формирование данных по требованиям Минфина России" version="1.0.2" CRC="3481825374" javascriptDocumentClassName="FOutlayAttach.Attach2FDocument" guid="G7D04AEC02DA7457BAEC06F4962A06364">
  <rules>
    <import id="JSHandlebars" sourceFile="Scripts\handlebars-v4.0.5.js" />
    <import id="JSStageSettings" sourceFile="MainLogic\ObasStageSettings.js" />
    <import id="JSTableFieldInfo" sourceFile="MainLogic\TableFieldInfo.js" />
    <import id="JSEvents" sourceFile="MainLogic\Events.js" />
    <import id="JSTableInfo" sourceFile="MainLogic\TableInfo.js" />
    <import id="JSRROTables" sourceFile="MainLogic\RROTables.js" />
    <import id="JSSprTables" sourceFile="MainLogic\SprTables.js" />
    <import id="JSObasTableCollection" sourceFile="MainLogic\ObasTableCollection.js" />
    <import id="JSHelper" sourceFile="MainLogic\ObasHelper.js" />
    <import id="JSFormatCollection" sourceFile="MainLogic\SheetFormatCollection.js" />
    <import id="JSCommon" sourceFile="MainLogic\CommonRules.js" />
    <import id="JSSettings" sourceFile="MainLogic\DocumentSettings.js" />
    <import id="JSGroupSheet" sourceFile="MainLogic\GroupSheet.js" />
    <import id="JSBaseDocument" sourceFile="MainLogic\BaseDocumentObject.js" />
    <import id="JSTable" sourceFile="MainLogic\FOutlayAttach\FOutlayAttach_TableRules.js" />
    <import id="JSInterface" sourceFile="MainLogic\FOutlayAttach\FOutlayAttach_InterfaceRules.js" />
    <import id="JSExport" sourceFile="MainLogic\FOutlayAttach\FOutlayAttach_ExportRules.js" />
    <import id="JSDocument" sourceFile="MainLogic\FOutlayAttach\FOutlayAttach_Document.js" />
  </rules>
  <tables>
    <linkedtable id="CSR" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="KOSGU" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="FCR" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="Files" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="dual" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="AddAnalysisIndicator" sourceFile="MainData\Spr_Main_User.xml" />
    <linkedtable id="RRO_Outlays" isSaveWithDocument="true" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_DATA" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="SELECTED_FOIV" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_OfficeChiefRecvisits" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_FinanceChiefRecvisits" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_ExecutorRecvisits" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_Expend_Shedule" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_Expend_Shedule" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_OBAS_Recvisits" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_OBAS_SC" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_OBAS_Numbers" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_OutlayRecvisits" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_PartIndicateBudgetValues" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_OBAS" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_OBAS_VERSIONS" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="tRRO_OBAS_VERSIONS" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RateDollarActual" sourceFile="MainData\Spr_Forms_STAGE1.xml" />
    <linkedtable id="tRateDollarActual" sourceFile="MainData\Spr_Forms_STAGE1.xml" />
    
    <linkedtable id="RRO_OBAS_AddAnalysisIndicator" sourceFile="MainData\RRO_STAGE1.xml" />

    <table id="FakeDataset" readonly="true">
      <fields>
        <field name="Id" datatype="guid" />
        <field name="Key" datatype="integer" />
        <field name="FakeApproved_Y1" datatype="float" precision="2" />
        <field name="FakeApproved_Usd_Y1" datatype="float" precision="5" />
        <field name="FakeDelta_Y1" datatype="float" precision="2" />
        <field name="FakeDelta_Usd_Y1" datatype="float" precision="5" />
        <field name="Fake_Y1" datatype="float" precision="2" />
        <field name="Fake_Usd_Y1" datatype="float" precision="5" />
        <field name="FakeApproved_Y2" datatype="float" precision="2" />
        <field name="FakeApproved_Usd_Y2" datatype="float" precision="5" />
        <field name="FakeDelta_Y2" datatype="float" precision="2" />
        <field name="FakeDelta_Usd_Y2" datatype="float" precision="5" />
        <field name="Fake_Y2" datatype="float" precision="2" />
        <field name="Fake_Usd_Y2" datatype="float" precision="5" />
        <field name="FakeApproved_Y3" datatype="float" precision="2" />
        <field name="FakeApproved_Usd_Y3" datatype="float" precision="5" />
        <field name="FakeDelta_Y3" datatype="float" precision="2" />
        <field name="FakeDelta_Usd_Y3" datatype="float" precision="5" />
        <field name="Fake_Y3" datatype="float" precision="2" />
        <field name="Fake_Usd_Y3" datatype="float" precision="5" />
        <field name="FakeApproved_Y4" datatype="float" precision="2" />
        <field name="FakeApproved_Usd_Y4" datatype="float" precision="5" />
        <field name="FakeDelta_Y4" datatype="float" precision="2" />
        <field name="FakeDelta_Usd_Y4" datatype="float" precision="5" />
        <field name="Fake_Y4" datatype="float" precision="2" />
        <field name="Fake_Usd_Y4" datatype="float" precision="5" />
        <field name="Fake_OKV_Code" datatype="string" size="50" />
        <field name="Fake_DAP_Code" datatype="string" size="8" />
        <field name="Fake_Deviation_Y1" datatype="string" size="1" />
        <field name="Fake_Deviation_Y2" datatype="string" size="1" />
        <field name="Fake_Deviation_Y3" datatype="string" size="1" />
        <field name="Fake_Deviation_Y4" datatype="string" size="1" />
        <field name="Fake_Lbo_Y1" datatype="float" precision="2" />
        <field name="Fake_Lbo_Y2" datatype="float" precision="2" />
        <field name="Fake_Lbo_Y3" datatype="float" precision="2" />
        <field name="Fake_Lbo_Y4" datatype="float" precision="2" />
        <field name="Fake_Obas_Code" datatype="string" size="100" />
        <field name="Fake_KOSGU_Code" datatype="string" size="3" />
      </fields>
    </table>
    <table id="MainParameters" caption="Основные параметры" canAdd="false" canClear="false" canDelete="false">
      <fields>
        <field name="Id" datatype="guid" />
        <field name="Key" datatype="integer" />
        <field name="AttachName" datatype="string" size="1000" />
        <field name="ExcelTemplate" datatype="string" size="1000" />
        <field name="ExcelName" datatype="string" size="1000" />
        <field name="ExcelDescription1" datatype="string" size="1000" />
        <field name="ExcelDescription2" datatype="string" size="1000" />
      </fields>
      <data>
        <row>
          <el><![CDATA[]]></el>
          <el><![CDATA[1]]></el>
          <el><![CDATA[ИЗМЕНЕНИЕ № {OutlayKey} ПОКАЗАТЕЛЕЙ БЮДЖЕНТОЙ СМЕТЫ НА Y1
(НА ПЛАНОВЫЙ ПЕРИОД Y2 и Y3 ГОДОВ)]]></el>
          <el><![CDATA[OutlayAttach1.xls]]></el>
          <el><![CDATA[Приложение № 2]]></el>
          <el><![CDATA[Приложение № 2 
к Общим требованиям к порядку составления, утверждения и ведения бюджетных смет
казенных учреждений, утвержденным приказом 
Министерства финансов Российской Федерации от 20.11.2007 № 112н
(с изм. от 23 сентября 2013 г., 17 декабря 2015 г., 30 сентября 2016 г.)]]></el>
        </row>
      </data>
    </table>
    <extendedtable id="tOutlayAttachRRO_OBAS_AddAnalysisIndicator" tables="RRO_OBAS_AddAnalysisIndicator" keys="RRO_Outlays_ID;MainAction_ID;VR_ID;DirectionCost_ID;SubProgram_ID;FCR_ID;Program_ID;AddAnalysisIndicator_ID">
      <fields>
        <field name="Y1_D" datatype="float" caption="Текущий год" precision="2">
          <rules>
            <rule name="ObasTableCollection.ObasVersionSumTable.AggregateEventHandler" event="OnAggregate" />
          </rules>
        </field>
        <field name="Y2_D" datatype="float" caption="Текущий год" precision="2">
          <rules>
            <rule name="ObasTableCollection.ObasVersionSumTable.AggregateEventHandler" event="OnAggregate" />
          </rules>
        </field>
        <field name="Y3_D" datatype="float" caption="Текущий год" precision="2">
          <rules>
            <rule name="ObasTableCollection.ObasVersionSumTable.AggregateEventHandler" event="OnAggregate" />
          </rules>
        </field>
        <field name="Y4_D" datatype="float" caption="Текущий год" precision="2">
          <rules>
            <rule name="ObasTableCollection.ObasVersionSumTable.AggregateEventHandler" event="OnAggregate" />
          </rules>
        </field>
      </fields>
      <rules>
        <rule name="ObasTableCollection.ObasVersionSumTable.FieldsCount" event="OnGetColumnsCount" />
        <rule name="ObasTableCollection.ObasVersionSumTable.GetFieldIndexEventHandler" event="OnGetColumnIndex" />
        <rule name="ObasTableCollection.ObasVersionSumTable.GetFieldValueEventHandler" event="OnGetColumnValue" />
      </rules>
    </extendedtable>
    <extendedtable id="OnlyOtherCostRRO_DATA" tables="RRO_DATA" keys="Key">
      <fields>
        <field name="RowCode" />
        <field name="RRO_Outlays_ID" />
        <field name="FCR_ID" />
        <field name="Program_ID" />
        <field name="SubProgram_ID" />
        <field name="MainAction_ID" />
        <field name="DirectionCost_ID" />
        <field name="VR_ID"  />
        <field name="FOIV_ID" />
        <field name="VR_Code" />
        <field name="VR_Name"  />
        <field name="FCR_CodeSection" datatype="string" size="200"/>
        <field name="FCR_CodeSubSection" datatype="string" size="200"/>
        <field name="CSR_Code" datatype="string" size="200"/>
        <field name="FCR_FullCodeSection" datatype="string" size="200"/>
      </fields>
      <rules>
        <rule name="%Doc%.TableRules.FilterOtherCostRroData" event="OnLoad"/>
      </rules>
    </extendedtable>
    <extendedtable id="OnlyInvestCostRRO_DATA" tables="RRO_DATA" keys="Key">
      <fields>
        <field name="RowCode" />
        <field name="RRO_Outlays_ID" />
        <field name="FCR_ID" />
        <field name="Program_ID" />
        <field name="SubProgram_ID" />
        <field name="MainAction_ID" />
        <field name="DirectionCost_ID" />
        <field name="VR_ID"  />
        <field name="FOIV_ID" />
        <field name="VR_Code" />
        <field name="VR_Name"  />
        <field name="FCR_CodeSection" datatype="string" size="200"/>
        <field name="FCR_CodeSubSection" datatype="string" size="200"/>
        <field name="CSR_Code" datatype="string" size="200"/>
        <field name="FCR_FullCodeSection" datatype="string" size="200"/>
      </fields>
      <rules>
        <rule name="%Doc%.TableRules.FilterInvestCostRroData" event="OnLoad"/>
      </rules>
    </extendedtable>
    <extendedtable id="OnlyOtherCostFCR" tables="FCR" keys="Key">
      <fields>
        <field name="CodeSection" />
        <field name="Name" />
        <field name="Code" />
      </fields>
      <rules>
        <rule name="%Doc%.TableRules.FilterOtherCostFcr" event="OnLoad"/>
      </rules>
    </extendedtable>
    <extendedtable id="OnlyInvestCostFCR" tables="FCR" keys="Key">
      <fields>
        <field name="CodeSection" />
        <field name="Name" />
        <field name="Code" />
      </fields>
      <rules>
        <rule name="%Doc%.TableRules.FilterInvestCostFcr" event="OnLoad"/>
      </rules>
    </extendedtable>
    <extendedtable id="CostTypeList" tables="RRO_DATA" keys="VR_ID">
      <rules>
        <rule name="%Doc%.TableRules.FilterIsActiveOutlayRroData" event="OnLoad"/>
      </rules>
    </extendedtable>
    <extendedtable id="tRRO_Part3IndicateBudgetValues" tables="RRO_PartIndicateBudgetValues" keys="RRO_Outlays_ID;MainAction_ID;VR_ID;DirectionCost_ID;SubProgram_ID;FCR_ID;Program_ID">
      <fields>
        <field name="Y1_D" datatype="float" precision="2">
          <rules>
            <rule name="ObasTableCollection.ObasVersionSumTable.AggregateEventHandler" event="OnAggregate" />
          </rules>
        </field>
        <field name="Y2_D" datatype="float" precision="2">
          <rules>
            <rule name="ObasTableCollection.ObasVersionSumTable.AggregateEventHandler" event="OnAggregate" />
          </rules>
        </field>
        <field name="Y3_D" datatype="float" precision="2">
          <rules>
            <rule name="ObasTableCollection.ObasVersionSumTable.AggregateEventHandler" event="OnAggregate" />
          </rules>
        </field>
        <field name="Y4_D" datatype="float" precision="2">
          <rules>
            <rule name="ObasTableCollection.ObasVersionSumTable.AggregateEventHandler" event="OnAggregate" />
          </rules>
        </field>
      </fields>
      <rules>
        <rule name="ObasTableCollection.ObasVersionSumTable.FieldsCount" event="OnGetColumnsCount" />
        <rule name="ObasTableCollection.ObasVersionSumTable.GetFieldIndexEventHandler" event="OnGetColumnIndex" />
        <rule name="ObasTableCollection.ObasVersionSumTable.GetFieldValueEventHandler" event="OnGetColumnValue" />
        <rule name="ObasTableCollection.RroPartIndicateBudgetValues.IsPart3" event="OnLoad"/>
      </rules>
    </extendedtable>
    <extendedtable id="OnlyWorkCostRRO_DATA" tables="RRO_DATA" keys="Key">
      <fields>
        <field name="RowCode" />
        <field name="RRO_Outlays_ID" />
        <field name="FCR_ID" />
        <field name="Program_ID" />
        <field name="SubProgram_ID" />
        <field name="MainAction_ID" />
        <field name="DirectionCost_ID" />
        <field name="VR_ID"  />
        <field name="FOIV_ID" />
        <field name="VR_Code" />
        <field name="VR_Name"  />
        <field name="FCR_CodeSection" datatype="string" size="200"/>
        <field name="FCR_CodeSubSection" datatype="string" size="200"/>
        <field name="CSR_Code" datatype="string" size="200"/>
        <field name="FCR_FullCodeSection" datatype="string" size="200"/>
      </fields>
      <rules>
        <rule name="%Doc%.TableRules.FilterWorkCostRroData" event="OnLoad"/>
      </rules>
    </extendedtable>
    <extendedtable id="OnlyWorkCostFCR" tables="FCR" keys="Key">
      <fields>
        <field name="CodeSection" />
        <field name="Name" />
        <field name="Code" />
      </fields>
      <rules>
        <rule name="%Doc%.TableRules.FilterWorkCostFcr" event="OnLoad"/>
      </rules>
    </extendedtable>
    <extendedtable id="tRRO_Part1Values" tables="RRO_OBAS_VERSIONS;RRO_PartIndicateBudgetValues" keys="RRO_Outlays_ID;MainAction_ID;VR_ID;DirectionCost_ID;SubProgram_ID;FCR_ID;Program_ID">
      <fields>
        <field name="Y1_D" datatype="float" precision="2">
          <rules>
            <rule name="ObasTableCollection.ObasVersionSumTable.AggregateEventHandler" event="OnAggregate" />
          </rules>
        </field>
        <field name="Y2_D" datatype="float" precision="2">
          <rules>
            <rule name="ObasTableCollection.ObasVersionSumTable.AggregateEventHandler" event="OnAggregate" />
          </rules>
        </field>
        <field name="Y3_D" datatype="float" precision="2">
          <rules>
            <rule name="ObasTableCollection.ObasVersionSumTable.AggregateEventHandler" event="OnAggregate" />
          </rules>
        </field>
        <field name="Y4_D" datatype="float" precision="2">
          <rules>
            <rule name="ObasTableCollection.ObasVersionSumTable.AggregateEventHandler" event="OnAggregate" />
          </rules>
        </field>
      </fields>
      <rules>
        <rule name="ObasTableCollection.ObasVersionSumTable.FieldsCount" event="OnGetColumnsCount" />
        <rule name="ObasTableCollection.ObasVersionSumTable.GetFieldIndexEventHandler" event="OnGetColumnIndex" />
        <rule name="ObasTableCollection.ObasVersionSumTable.GetFieldValueEventHandler" event="OnGetColumnValue" />
        <rule name="%Doc%.TableRules.FilterRroPart1Data" event="OnLoad"/>
      </rules>
    </extendedtable>
  </tables>
  <sheets>
    <gridsheet title="Раздел 1.#Year" name="Sheet_1_Y1">
      <view table="OnlyWorkCostFCR" readonly="true">
        <view table="OnlyWorkCostRRO_DATA" readonly="true" masterKeys="FCR_FullCodeSection" detailKeys="OnlyWorkCostFCR.Code">
          <col width="200" readonly="true" caption="Наименование показателя" name="VR_Name" align="left" valign="center" />
          <col width="50" readonly="true" caption="Код строки" name="RowCode" align="center" valign="center" />
          <view caption="Код по бюджетной классификации Российской Федерации">
            <col width="100" readonly="true" caption="раздела" name="FCR_CodeSection" align="center" valign="center" />
            <col width="100" readonly="true" caption="подраздела" name="FCR_CodeSubSection" align="center" valign="center" />
            <col width="200" readonly="true" caption="целевой статьи" name="CSR_Code" align="center" valign="center" />
            <col width="100" readonly="true" caption="вида расходов" name="VR_CODE" align="center" valign="center" />
          </view>
          <view table="tRRO_Part1Values" readonly="true" masterKeys="RRO_Outlays_ID;MainAction_ID;VR_ID;DirectionCost_ID;SubProgram_ID;FCR_ID;Program_ID" detailKeys="OnlyWorkCostRRO_DATA.RRO_Outlays_ID;OnlyWorkCostRRO_DATA.MainAction_ID;OnlyWorkCostRRO_DATA.VR_ID;OnlyWorkCostRRO_DATA.DirectionCost_ID;OnlyWorkCostRRO_DATA.SubProgram_ID;OnlyWorkCostRRO_DATA.FCR_ID;OnlyWorkCostRRO_DATA.Program_ID">
            <view table="FakeDataset">
              <template>
                <col width="100" readonly="true" caption="Код аналитического показателя" name="Fake_DAP_Code" align="center" valign="center" />
                <view caption="Сумма на {caption} год">
                  <col width="120" readonly="true" caption="в рублях, (рублевой эквивалент)" name="Fake_Y{fieldName}" align="right" valign="center" displayFormat=",0.00" />
                  <col width="120" readonly="true" caption="в валюте" name="Fake_Usd_Y{fieldName}" align="right" valign="center" displayFormat=",0.00000" />
                  <col width="120" readonly="true" caption="Код валюты" name="Fake_OKV_Code" align="center" valign="center" />
                </view>
                <rules>
                  <rule name="%Doc%.PXGroupSheet.GetYearsFieldRangeEventHandler" event="OnGetFieldsRange"/>
                  <rule name="%Doc%.PXGroupSheet.GetYearsCaptionEventHandler" event="OnGetCaption"/>
                </rules>
              </template>
            </view>
            <template>
              <col name="Y{fieldName}_D" columnName="Fake_Y{columnName}" readonly="true" />
              <rules>
                <rule name="%Doc%.PXGroupSheet.GetYearsFieldRangeEventHandler" event="OnGetFieldsRange"/>
              </rules>
            </template>
          </view>
          <view table="tOutlayAttachRRO_OBAS_AddAnalysisIndicator" readonly="true" masterKeys="RRO_Outlays_ID;MainAction_ID;VR_ID;DirectionCost_ID;SubProgram_ID;FCR_ID;Program_ID" detailKeys="OnlyWorkCostRRO_DATA.RRO_Outlays_ID;OnlyWorkCostRRO_DATA.MainAction_ID;OnlyWorkCostRRO_DATA.VR_ID;OnlyWorkCostRRO_DATA.DirectionCost_ID;OnlyWorkCostRRO_DATA.SubProgram_ID;OnlyWorkCostRRO_DATA.FCR_ID;OnlyWorkCostRRO_DATA.Program_ID">
            <view table="AddAnalysisIndicator" masterKeys="Key" detailKeys="tOutlayAttachRRO_OBAS_AddAnalysisIndicator.AddAnalysisIndicator_ID">
              <col name="FullCode" columnName="Fake_DAP_Code" readonly="true" />
              <col name="Name" columnName="VR_Name" readonly="true" />
            </view>
            <template>
              <col name="Y{fieldName}_D" columnName="Fake_Y{columnName}" readonly="true" />
              <rules>
                <rule name="%Doc%.PXGroupSheet.GetYearsFieldRangeEventHandler" event="OnGetFieldsRange"/>
              </rules>
            </template>
          </view>
        </view>
        <col name="Name" columnName="VR_Name" readonly="true" />
        <col name="CodeSection" columnName="FCR_CodeSection" readonly="true" />
        <view table="dual"/>
      </view>
      <view table="dual"/>
      <rules>
        <rule name="%Doc%.PXGroupSheet.CalcEventHandler" event="OnCalc"/>
        <rule name="%Doc%.PXGroupSheet.CreateCaptionEventHandler" event="OnCreateTitle" />
      </rules>
    </gridsheet>
    <generatedsheet name="Sheet_1_Y2" templateSheetName="Sheet_1_Y1" />
    <generatedsheet name="Sheet_1_Y3" templateSheetName="Sheet_1_Y1" />
    <gridsheet title="Раздел 2.#Year" name="Sheet_2_Y1">
      <view table="OnlyInvestCostFCR" readonly="true">
        <view table="OnlyInvestCostRRO_DATA" readonly="true" masterKeys="FCR_FullCodeSection" detailKeys="OnlyInvestCostFCR.Code">
          <col width="200" readonly="true" caption="Наименование показателя" name="VR_Name" align="left" valign="center" />
          <col width="50" readonly="true" caption="Код строки" name="RowCode" align="center" valign="center" />
          <view caption="Код по бюджетной классификации Российской Федерации">
            <col width="100" readonly="true" caption="раздела" name="FCR_CodeSection" align="center" valign="center" />
            <col width="100" readonly="true" caption="подраздела" name="FCR_CodeSubSection" align="center" valign="center" />
            <col width="200" readonly="true" caption="целевой статьи" name="CSR_Code" align="center" valign="center" />
            <col width="100" readonly="true" caption="вида расходов" name="VR_CODE" align="center" valign="center" />
          </view>
          <view table="tRRO_OBAS_VERSIONS" readonly="true" masterKeys="RRO_Outlays_ID;MainAction_ID;VR_ID;DirectionCost_ID;SubProgram_ID;FCR_ID;Program_ID" detailKeys="OnlyInvestCostRRO_DATA.RRO_Outlays_ID;OnlyInvestCostRRO_DATA.MainAction_ID;OnlyInvestCostRRO_DATA.VR_ID;OnlyInvestCostRRO_DATA.DirectionCost_ID;OnlyInvestCostRRO_DATA.SubProgram_ID;OnlyInvestCostRRO_DATA.FCR_ID;OnlyInvestCostRRO_DATA.Program_ID">
            <view table="FakeDataset">
              <template>
                <col width="100" readonly="true" caption="Код аналитического показателя" name="Fake_DAP_Code" align="center" valign="center" />
                <view caption="Сумма на {caption} год">
                  <col width="120" readonly="true" caption="в рублях, (рублевой эквивалент)" name="Fake_Y{fieldName}" align="right" valign="center" displayFormat=",0.00" />
                  <col width="120" readonly="true" caption="в валюте" name="Fake_Usd_Y{fieldName}" align="right" valign="center" displayFormat=",0.00000" />
                  <col width="120" readonly="true" caption="Код валюты" name="Fake_OKV_Code" align="center" valign="center" />
                </view>
                <rules>
                  <rule name="%Doc%.PXGroupSheet.GetYearsFieldRangeEventHandler" event="OnGetFieldsRange"/>
                  <rule name="%Doc%.PXGroupSheet.GetYearsCaptionEventHandler" event="OnGetCaption"/>
                </rules>
              </template>
            </view>
            <template>
              <col name="Y{fieldName}_D" columnName="Fake_Y{columnName}" readonly="true" />
              <rules>
                <rule name="%Doc%.PXGroupSheet.GetYearsFieldRangeEventHandler" event="OnGetFieldsRange"/>
              </rules>
            </template>
          </view>
          <view table="tOutlayAttachRRO_OBAS_AddAnalysisIndicator" readonly="true" masterKeys="RRO_Outlays_ID;MainAction_ID;VR_ID;DirectionCost_ID;SubProgram_ID;FCR_ID;Program_ID" detailKeys="OnlyInvestCostRRO_DATA.RRO_Outlays_ID;OnlyInvestCostRRO_DATA.MainAction_ID;OnlyInvestCostRRO_DATA.VR_ID;OnlyInvestCostRRO_DATA.DirectionCost_ID;OnlyInvestCostRRO_DATA.SubProgram_ID;OnlyInvestCostRRO_DATA.FCR_ID;OnlyInvestCostRRO_DATA.Program_ID">
            <view table="AddAnalysisIndicator" masterKeys="Key" detailKeys="tOutlayAttachRRO_OBAS_AddAnalysisIndicator.AddAnalysisIndicator_ID">
              <col name="FullCode" columnName="Fake_DAP_Code" readonly="true" />
              <col name="Name" columnName="VR_Name" readonly="true" />
            </view>
            <template>
              <col name="Y{fieldName}_D" columnName="Fake_Y{columnName}" readonly="true" />
              <rules>
                <rule name="%Doc%.PXGroupSheet.GetYearsFieldRangeEventHandler" event="OnGetFieldsRange"/>
              </rules>
            </template>
          </view>
        </view>
        <col name="Name" columnName="VR_Name" readonly="true" />
        <col name="CodeSection" columnName="FCR_CodeSection" readonly="true" />
        <view table="dual"/>
      </view>
      <view table="dual"/>
      <rules>
        <rule name="%Doc%.PXGroupSheet.CalcEventHandler" event="OnCalc"/>
        <rule name="%Doc%.PXGroupSheet.CreateCaptionEventHandler" event="OnCreateTitle" />
      </rules>
    </gridsheet>
    <generatedsheet name="Sheet_2_Y2" templateSheetName="Sheet_2_Y1" />
    <generatedsheet name="Sheet_2_Y3" templateSheetName="Sheet_2_Y1" />
    <gridsheet title="Раздел 3.#Year" name="Sheet_3_Y1">
      <view table="OnlyOtherCostFCR" readonly="true">
        <view table="OnlyOtherCostRRO_DATA" readonly="true" masterKeys="FCR_FullCodeSection" detailKeys="OnlyOtherCostFCR.Code">
          <col width="200" readonly="true" caption="Наименование показателя" name="VR_Name" align="left" valign="center" />
          <col width="50" readonly="true" caption="Код строки" name="RowCode" align="center" valign="center" />
          <view caption="Код по бюджетной классификации Российской Федерации">
            <col width="100" readonly="true" caption="раздела" name="FCR_CodeSection" align="center" valign="center" />
            <col width="100" readonly="true" caption="подраздела" name="FCR_CodeSubSection" align="center" valign="center" />
            <col width="200" readonly="true" caption="целевой статьи" name="CSR_Code" align="center" valign="center" />
            <col width="100" readonly="true" caption="вида расходов" name="VR_CODE" align="center" valign="center" />
          </view>
          <view table="tRRO_Part3IndicateBudgetValues" readonly="true" masterKeys="RRO_Outlays_ID;MainAction_ID;VR_ID;DirectionCost_ID;SubProgram_ID;FCR_ID;Program_ID" detailKeys="OnlyOtherCostRRO_DATA.RRO_Outlays_ID;OnlyOtherCostRRO_DATA.MainAction_ID;OnlyOtherCostRRO_DATA.VR_ID;OnlyOtherCostRRO_DATA.DirectionCost_ID;OnlyOtherCostRRO_DATA.SubProgram_ID;OnlyOtherCostRRO_DATA.FCR_ID;OnlyOtherCostRRO_DATA.Program_ID">
            <view table="FakeDataset">
              <template>
                <col width="100" readonly="true" caption="Код аналитического показателя" name="Fake_DAP_Code" align="center" valign="center" />
                <view caption="Сумма на {caption} год">
                  <col width="120" readonly="true" caption="в рублях, (рублевой эквивалент)" name="Fake_Y{fieldName}" align="right" valign="center" displayFormat=",0.00" />
                  <col width="120" readonly="true" caption="в валюте" name="Fake_Usd_Y{fieldName}" align="right" valign="center" displayFormat=",0.00000" />
                  <col width="120" readonly="true" caption="Код валюты" name="Fake_OKV_Code" align="center" valign="center" />
                </view>
                <rules>
                  <rule name="%Doc%.PXGroupSheet.GetYearsFieldRangeEventHandler" event="OnGetFieldsRange"/>
                  <rule name="%Doc%.PXGroupSheet.GetYearsCaptionEventHandler" event="OnGetCaption"/>
                </rules>
              </template>
            </view>
            <template>
              <col name="Y{fieldName}_D" columnName="Fake_Y{columnName}" readonly="true" />
              <rules>
                <rule name="%Doc%.PXGroupSheet.GetYearsFieldRangeEventHandler" event="OnGetFieldsRange"/>
              </rules>
            </template>
          </view>
        </view>
        <col name="Name" columnName="VR_Name" readonly="true" />
        <col name="CodeSection" columnName="FCR_CodeSection" readonly="true" />
        <view table="dual"/>
      </view>
      <view table="dual"/>
      <rules>
        <rule name="%Doc%.PXGroupSheet.CalcEventHandler" event="OnCalc"/>
        <rule name="%Doc%.PXGroupSheet.CreateCaptionEventHandler" event="OnCreateTitle" />
      </rules>
    </gridsheet>
    <generatedsheet name="Sheet_3_Y2" templateSheetName="Sheet_3_Y1" />
    <generatedsheet name="Sheet_3_Y3" templateSheetName="Sheet_3_Y1" />
    <gridsheet title="Раздел 4.#Year" name="Sheet_4_Y1">
      <view table="CostTypeList" readonly="true">
        <view table="RRO_DATA" readonly="true" masterKeys="VR_ID" detailKeys="CostTypeList.VR_ID">
          <view caption="Код по бюджетной классификации Российской Федерации">
            <col width="100" readonly="true" caption="раздела" name="FCR_CodeSection" align="center" valign="center" />
            <col width="100" readonly="true" caption="подраздела" name="FCR_CodeSubSection" align="center" valign="center" />
            <col width="200" readonly="true" caption="целевой статьи" name="CSR_Code" align="center" valign="center" />
            <col width="100" readonly="true" caption="вида расходов" name="VR_CODE" align="center" valign="center" />
          </view>
          <view table="tRRO_OBAS_VERSIONS" readonly="true" masterKeys="RRO_Outlays_ID;MainAction_ID;VR_ID;DirectionCost_ID;SubProgram_ID;FCR_ID;Program_ID" detailKeys="RRO_DATA.RRO_Outlays_ID;RRO_DATA.MainAction_ID;RRO_DATA.VR_ID;RRO_DATA.DirectionCost_ID;RRO_DATA.SubProgram_ID;RRO_DATA.FCR_ID;RRO_DATA.Program_ID">
            <view table="FakeDataset">
              <template>
                <col width="100" readonly="true" caption="Код аналитического показателя" name="Fake_DAP_Code" align="center" valign="center" />
                <view caption="Сумма на {caption} год">
                  <col width="120" readonly="true" caption="в рублях, (рублевой эквивалент)" name="Fake_Y{fieldName}" align="right" valign="center" displayFormat=",0.00" />
                  <col width="120" readonly="true" caption="в валюте" name="Fake_Usd_Y{fieldName}" align="right" valign="center" displayFormat=",0.00000" />
                  <col width="120" readonly="true" caption="Код валюты" name="Fake_OKV_Code" align="center" valign="center" />
                </view>
                <rules>
                  <rule name="%Doc%.P4GroupSheet.GetYearsFieldRangeEventHandler" event="OnGetFieldsRange"/>
                  <rule name="%Doc%.P4GroupSheet.GetYearsCaptionEventHandler" event="OnGetCaption"/>
                </rules>
              </template>
            </view>
            <template>
              <col name="Y{fieldName}_D" columnName="Fake_Y{columnName}" readonly="true" />
              <rules>
                <rule name="%Doc%.P4GroupSheet.GetYearsFieldRangeEventHandler" event="OnGetFieldsRange"/>
              </rules>
            </template>
          </view>
          <view table="tOutlayAttachRRO_OBAS_AddAnalysisIndicator" readonly="true" masterKeys="RRO_Outlays_ID;MainAction_ID;VR_ID;DirectionCost_ID;SubProgram_ID;FCR_ID;Program_ID" detailKeys="RRO_DATA.RRO_Outlays_ID;RRO_DATA.MainAction_ID;RRO_DATA.VR_ID;RRO_DATA.DirectionCost_ID;RRO_DATA.SubProgram_ID;RRO_DATA.FCR_ID;RRO_DATA.Program_ID" isNextViewAlwaysInsertRow="true">
            <view table="AddAnalysisIndicator" masterKeys="Key" detailKeys="tOutlayAttachRRO_OBAS_AddAnalysisIndicator.AddAnalysisIndicator_ID">
              <col name="FullCode" columnName="Fake_DAP_Code" readonly="true" />
            </view>
            <template>
              <col name="Y{fieldName}_D" columnName="Fake_Y{columnName}" readonly="true" />
              <rules>
                <rule name="%Doc%.P4GroupSheet.GetYearsFieldRangeEventHandler" event="OnGetFieldsRange"/>
              </rules>
            </template>
          </view>
          <view table="dual"/>
          <rules>
            <rule name="ObasTableCollection.RroDataTable.IsActiveOutlayLoadEventHandler" event="OnLoad" />
          </rules>
        </view>
      </view>
      <view table="dual"/>
      <rules>
        <rule name="%Doc%.P4GroupSheet.CalcEventHandler" event="OnCalc"/>
        <rule name="%Doc%.P4GroupSheet.CreateCaptionEventHandler" event="OnCreateTitle" />
      </rules>
    </gridsheet>
    <generatedsheet name="Sheet_4_Y2" templateSheetName="Sheet_4_Y1" />
    <generatedsheet name="Sheet_4_Y3" templateSheetName="Sheet_4_Y1" />
    <rules>
      <rule name="%Doc%.InterfaceRules.GetExcelTemplateFileName" event="OnGetTemplateFileName" />
      <rule name="%Doc%.InterfaceRules.GetExcelFileName" event="OnGetExportFileName" />
      <rule name="ObasHelper.GetFalse" event="OnBeforeDocumentSave" />
    </rules>
  </sheets>
</document>