<?xml version="1.0" encoding="utf-8"?>
<document caption="Формирование данных по требованиям Минфина России" CRC="683453222" version="1.0.8" javascriptDocumentClassName="F04120.FDocument">
  <rules>
    <import id="JSHandlebars" sourceFile="Scripts\handlebars-v4.0.5.js" />
    <import id="JSStageSettings" sourceFile="MainLogic\ObasStageSettings.js" />
    <import id="JSTableFieldInfo" sourceFile="MainLogic\TableFieldInfo.js" />
    <import id="JSEvents" sourceFile="MainLogic\Events.js" />
    <import id="JSTableInfo" sourceFile="MainLogic\TableInfo.js" />
    <import id="JSRROTables" sourceFile="MainLogic\RROTables.js" />
    <import id="JSSprTables" sourceFile="MainLogic\SprTables.js" />
    <import id="JSObasTableCollection" sourceFile="MainLogic\ObasTableCollection.js" />
    <import id="JSHelper" sourceFile="MainLogic\ObasHelper.js" />
    <import id="JSFormatCollection" sourceFile="MainLogic\SheetFormatCollection.js" />
    <import id="JSCommon" sourceFile="MainLogic\CommonRules.js" />
    <import id="JSSettings" sourceFile="MainLogic\DocumentSettings.js" />
    <import id="JSBaseDocument" sourceFile="MainLogic\BaseDocumentObject.js" />
    <import id="JSObasTableWithKeys" sourceFile="MainLogic\ObasTableWithKeys.js" />
    <import id="JSUpdate" sourceFile="Templates\Logic\Current\F04_120\F04_120_UpdateRules.js" />
    <import id="JSInterface" sourceFile="Templates\Logic\Current\F04_120\F04_120_InterfaceRules.js" />
    <import id="JSTable" sourceFile="Templates\Logic\Current\F04_120\F04_120_TableRules.js" />
    <import id="JSExport" sourceFile="Templates\Logic\Current\F04_120\F04_120_ExportRules.js" />
    <import id="JSDocument" sourceFile="Templates\Logic\Current\F04_120\F04_120_Document.js" />
  </rules>
  <tables>
    <linkedtable id="FOIV" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="FCR" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="CSR" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="Program" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="SubProgram" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="DirectionCost" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="VR" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="MainAction" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="OBAS_SPR" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="NPAType" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="KOSGU" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="OKVED" sourceFile="MainData\Spr_Forms_STAGE1.xml" />
    <linkedtable id="OKEI" sourceFile="MainData\Spr_Forms_STAGE1.xml" />
    <linkedtable id="OKSM" sourceFile="MainData\Spr_Forms_STAGE1.xml" />
    <linkedtable id="InvestigationTypes" sourceFile="MainData\Spr_Forms_STAGE1.xml" />
    <linkedtable id="RRO_OBAS_VERSIONS" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_OBAS" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_DATA" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_OBAS_Recvisits" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_OBAS_SC" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_OBAS_Numbers" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="SecurityTypes" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="ChangeType" sourceFile="MainData\Spr_Ped.xml" />
    <linkedtable id="RRO_KU_Data" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="FileType" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="BuildParams" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_Expend_Shedule" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_OfficeChiefRecvisits" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_FinanceChiefRecvisits" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RRO_ExecutorRecvisits" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="SELECTED_FOIV" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="tRRO_OBAS_VERSIONS" sourceFile="MainData\RRO_STAGE1.xml" />
    <linkedtable id="RateDollarActual" sourceFile="MainData\Spr_Forms_STAGE1.xml" />
    <linkedtable id="tRateDollarActual" sourceFile="MainData\Spr_Forms_STAGE1.xml" />
    <linkedtable id="Files" sourceFile="MainData\Spr_Main.xml" />
    <linkedtable id="dual" sourceFile="MainData\Spr_Main.xml" />
    <table id="MainParameters" readonly="true" caption="Основные параметры" canAdd="false" canClear="false" canDelete="false">
      <fields>
        <field name="Id" datatype="guid" />
        <field name="Key" datatype="integer" />
        <sourcefield name="FOIV_ID" table="FOIV" tableKeyField="Key" tableFields="Code;Name" />
        <sourcefield name="FCR_ID" table="FCR" tableKeyField="Key" tableFields="Code;Name" />
        <sourcefield name="VR_ID" table="VR" tableKeyField="Key" tableFields="Code;Name" />
        <sourcefield name="CSR_ID" table="CSR" tableKeyField="Key" tableFields="Code;Name" />
        <sourcefield name="MainAction_ID" table="MainAction" tableKeyField="Key" tableFields="Code;Name" />
        <lookupfield name="FCR_NAME" keys="FCR_ID" lookupTable="FCR" lookupKeys="Key" lookupFields="Name" />
        <sourcefield name="RRO_OBAS_VERSIONS_ID" table="RRO_OBAS_VERSIONS" tableKeyField="Key" tableFields="Key" />
        <sourcefield name="FileType_ID" table="FileType" tableKeyField="Key" tableFields="Key" />
        <sourcefield name="Program_ID" table="Program" tableKeyField="Key" tableFields="Key" />
        <sourcefield name="SubProgram_ID" table="SubProgram" tableKeyField="Key" tableFields="Key" />
        <sourcefield name="DirectionCost_ID" table="DirectionCost" tableKeyField="Key" tableFields="Key" />
      </fields>
      <data>
        <row>
          <el><![CDATA[]]></el>
          <el><![CDATA[1]]></el>
        </row>
      </data>
    </table>
    <table id="FormParameters" caption="Параметры формы" readonly="true">
      <fields>
        <field name="Id" datatype="guid" />
        <field name="Key" datatype="integer" />
        <field name="FormSecretType" datatype="integer" caption="Признак гостайны" />
        <field name="TableNameWithTotals" datatype="string" size="50" />
        <field name="TableWithKOSGU" datatype="string" size="50" />
        <field name="AnalyticsTable" datatype="string" size="50" />
        <field name="AnalyticsStartF" datatype="integer" caption="Начальный индекс обработки полей" />
        <field name="AnalyticsEndF" datatype="integer" caption="Конечный идекс обработки полей" />
      </fields>
      <data>
        <row>
          <el><![CDATA[]]></el>
          <el><![CDATA[1]]></el>
          <el><![CDATA[0]]></el>
          <el><![CDATA[F04_120_R1_Values]]></el>
          <el><![CDATA[KOSGU_Data]]></el>
        </row>
      </data>
    </table>
    <!--F04_120-->
    <table id="F04_120_R1_Rows" readonly="true">
      <fields>
        <field name="Id" datatype="guid" />
        <field name="Key" datatype="integer" />
        <field name="Name" datatype="string" />
      </fields>
      <data>
        <row>
          <el><![CDATA[]]></el>
          <el><![CDATA[1]]></el>
          <el><![CDATA[Объекты государственной собственности Российской Федерации за пределами территории Российской Федерации]]></el>
        </row>
      </data>
    </table>
    <table id="F04_120_R1_Values">
      <fields>
        <field name="Id" datatype="guid" />
        <field name="Key" datatype="integer" />
        <field name="StrKey" datatype="string" syncKey="true" />
        <field name="IsTotal" datatype="integer" syncKey="true" />
        <field name="Y1" datatype="float" size="20" precision="2">
          <rules>
            <rule name="%Doc%.P1TotalTable.SumChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="Y2" datatype="float" size="20" precision="2">
          <rules>
            <rule name="%Doc%.P1TotalTable.SumChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="Y3" datatype="float" size="20" precision="2">
          <rules>
            <rule name="%Doc%.P1TotalTable.SumChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="Y4" datatype="float" size="20" precision="2">
          <rules>
            <rule name="%Doc%.P1TotalTable.SumChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="Y5" datatype="float" precision="2">
          <rules>
            <rule name="%Doc%.P1TotalTable.SumChangeEventHandler" event="OnChange" />
          </rules>
        </field>
      </fields>
      <rules>
        <rule name="%Doc%.CommonRules.SaveTotalTable" event="OnSave" />
      </rules>
      <data>
        <row>
          <el><![CDATA[]]></el>
          <el><![CDATA[1]]></el>
          <el><![CDATA[1]]></el>
          <el><![CDATA[1]]></el>
          <el><![CDATA[0]]></el>
          <el><![CDATA[0]]></el>
          <el><![CDATA[0]]></el>
          <el><![CDATA[0]]></el>
          <el><![CDATA[0]]></el>
        </row>
      </data>
    </table>
    <table id="F04_120_R2_1">
      <fields>
        <field name="Id" datatype="guid" />
        <field name="Key" datatype="integer" />
        <field name="StrCode" datatype="string" size="4" />
        <field name="Name" datatype="string" size="1000" isNull="false" uniqueLabel="1" caption="Наименование объекта" />
        <sourcefield name="OKSM_ID" isNull="false" uniqueLabel="1" caption="Наименование страны" table="OKSM" tableKeyField="Key" tableFields="Name" />
        <field name="City" datatype="string" size="100" isNull="false" uniqueLabel="1" caption="Наименование города" />
        <field name="Year" datatype="integer" caption="Год завершения строительства" isDeltaValue="false" />
        <!--НПА-->
        <sourcefield name="NPAType_ID" caption="Вид акта" table="NPAType" tableKeyField="Key" tableFields="Name" />
        <field name="NPA_Date" datatype="datetime" caption="дата акта" />
        <field name="NPA_Num" datatype="string" size="50" caption="Номер акта" />
        <field name="NPA_Name" datatype="string" size="1000" caption="Наименование акта" />
        <!--Данные-->
        <field name="g6" datatype="float" precision="5" caption="Остаток сметной стоимости объекта" />
        <field name="USD_Y1" datatype="float" precision="5" caption="ОБАС Y1 USD">
          <rules>
            <rule name="%Doc%.P2ObjectDataTable.UsdChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="Y1" datatype="float" precision="2" caption="ОБАС Y1 RUB">
          <rules>
            <rule name="%Doc%.P2ObjectDataTable.SumChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="USD_Y2" datatype="float" precision="5" caption="ОБАС Y2 USD">
          <rules>
            <rule name="%Doc%.P2ObjectDataTable.UsdChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="Y2" datatype="float" precision="2" caption="ОБАС Y2 RUB">
          <rules>
            <rule name="%Doc%.P2ObjectDataTable.SumChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="USD_Y3" datatype="float" precision="5" caption="ОБАС Y3 USD">
          <rules>
            <rule name="%Doc%.P2ObjectDataTable.UsdChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="Y3" datatype="float" precision="2" caption="ОБАС Y3 RUB">
          <rules>
            <rule name="%Doc%.P2ObjectDataTable.SumChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="USD_Y4" datatype="float" precision="5" caption="ОБАС Y4 USD">
          <rules>
            <rule name="%Doc%.P2ObjectDataTable.UsdChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="Y4" datatype="float" precision="2" caption="ОБАС Y4 RUB">
          <rules>
            <rule name="%Doc%.P2ObjectDataTable.SumChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="USD_Y5" datatype="float" precision="5" caption="ОБАС Y5 USD">
          <rules>
            <rule name="%Doc%.P2ObjectDataTable.UsdChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="Y5" datatype="float" precision="2" caption="ОБАС Y5 RUB">
          <rules>
            <rule name="%Doc%.P2ObjectDataTable.SumChangeEventHandler" event="OnChange" />
          </rules>
        </field>
      </fields>
    </table>
    <table id="F04_120_R2_2">
      <fields>
        <field name="Id" datatype="guid" />
        <field name="Key" datatype="integer" />
        <field name="StrCode" datatype="string" size="4" />
        <sourcefield name="OwnerKey" uniqueLabel="1" caption="Объект государственной собственности" table="F04_120_R2_1" tableKeyField="Key" tableFields="Name">
          <rules>
            <rule name="%Doc%.P2InvestDataTable.OwnerKey.InitEventHandler" event="OnInit" />
          </rules>
        </sourcefield>
        <sourcefield name="Investigation_ID" isNull="false" uniqueLabel="1" caption="Направление инвестирования" table="InvestigationTypes" tableKeyField="Key" tableFields="Name" />
        <sourcefield name="OKEI_ID" isNull="false" uniqueLabel="1" caption="Единица измерения" table="OKEI" tableKeyField="Key" tableFields="Name" />
        <field name="g6" datatype="float" precision="2" caption="Мощность" isDeltaValue="false" />
        <field name="USD_Y1" datatype="float" precision="5" caption="ОБАС Y1 USD">
          <rules>
            <rule name="%Doc%.P2InvestDataTable.UsdChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="Y1" datatype="float" precision="2" caption="ОБАС Y1 RUB" />
        <field name="USD_Y2" datatype="float" precision="5" caption="ОБАС Y2 USD">
          <rules>
            <rule name="%Doc%.P2InvestDataTable.UsdChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="Y2" datatype="float" precision="2" caption="ОБАС Y2 RUB" />
        <field name="USD_Y3" datatype="float" precision="5" caption="ОБАС Y3 USD">
          <rules>
            <rule name="%Doc%.P2InvestDataTable.UsdChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="Y3" datatype="float" precision="2" caption="ОБАС Y3 RUB" />
        <field name="USD_Y4" datatype="float" precision="5" caption="ОБАС Y4 USD">
          <rules>
            <rule name="%Doc%.P2InvestDataTable.UsdChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="Y4" datatype="float" precision="2" caption="ОБАС Y4 RUB" />
        <field name="USD_Y5" datatype="float" precision="5" caption="ОБАС Y5 USD">
          <rules>
            <rule name="%Doc%.P2InvestDataTable.UsdChangeEventHandler" event="OnChange" />
          </rules>
        </field>
        <field name="Y5" datatype="float" precision="2" caption="ОБАС Y5 RUB" />
      </fields>
      <rules>
        <rule name="%Doc%.P2InvestDataTable.AfterDeleteChildsEventHandler" event="OnAfterDeleteChilds" />
      </rules>
    </table>
    <table id="KOSGU_Data">
      <fields>
        <field name="Id" datatype="guid" />
        <field name="Key" datatype="integer" />
        <sourcefield name="KOSGU_Id" table="KOSGU" tableKeyField="Key" tableFields="Key" syncKey="true" />
        <field name="SrcKey" datatype="integer" isDeltaValue="false" />
        <field name="Y1" datatype="float" precision="2" />
        <field name="Y2" datatype="float" precision="2" />
        <field name="Y3" datatype="float" precision="2" />
        <field name="Y4" datatype="float" precision="2" />
      </fields>
      <rules>
        <rule name="%Doc%.CommonRules.SaveKosguTable" event="OnSave" />
      </rules>
      <data>
        <row>
          <el><![CDATA[]]></el>
          <el><![CDATA[1]]></el>
          <el><![CDATA[27561076]]></el>
          <el><![CDATA[1]]></el>
        </row>
      </data>
    </table>
  </tables>
  <sheets>
    <gridsheet title="Раздел 1" name="SHT_F04_120_R1" exportable="false" caption="1. Расчет на осуществление капитальных вложений " isShowColumnNumbers="true">
      <view table="F04_120_R1_Rows" readonly="true">
        <col width="300" name="Name" align="left" readonly="true" caption="Наименование показателя" />
        <view table="F04_120_R1_Values" masterKeys="StrKey" detailKeys="Key" readonly="true">
          <view caption="Сумма, руб">
            <template>
              <col width="150" name="Y{fieldName}" caption="на {caption} год" align="right" displayFormat=",0.00" />
              <rules>
                <rule name="%Doc%.AddYearsHelper.GetYearsFieldRangeEventHandler" event="OnGetFieldsRange" />
                <rule name="%Doc%.CommonRules.GetYearsCaptionEventHandler" event="OnGetCaption" />
              </rules>
            </template>
          </view>
          <template>
            <col width="150" name="Y{fieldName}" caption="Сумма, подлежащих исполнению за пределами планового периода" align="right" displayFormat=",0.00" />
            <rules>
              <rule name="%Doc%.AddYearsHelper.GetAddYearsFieldRangeEventHandler" event="OnGetFieldsRange" />
            </rules>
          </template>
        </view>
      </view>
      <rules>
        <rule name="%Doc%.InterfaceRules.SheetP1FormatEventHandler" event="OnGetFormat" />
      </rules>
    </gridsheet>
    <gridsheet title="Раздел 2.1" name="SHT_F04_120_R2_1" exportable="false" caption="2. Расчет на предоставление бюджетных инвестиций и предоставление субсидий на осуществление капитальных вложений в объекты государственной собственности Российской Федерации за пределами территории Российской Федерации&#xD;&#xA;2.1. Расчет" isShowColumnNumbers="true">
      <view table="F04_120_R2_1">
        <col width="200" name="Name" align="left" readonly="true" caption="Наименование объекта" />
        <view caption="Наименование" readonly="true">
          <col width="200" name="OKSM_ID" align="left" caption="страна" />
          <col width="200" name="City" align="left" caption="город" />
        </view>
        <col width="100" name="Year" align="center" caption="Год завершения строительства (реконструкции, технического перевооружения) или приобретения" />
        <col width="50" name="StrCode" align="center" readonly="true" caption="Код строки" />
        <col width="150" name="g6" align="right" displayFormat=",0.00000" caption="Остаток сметной стоимости объекта капитального строительства&#xD;&#xA;на 1 января текущего финансового года в ценах соответствующих лет,&#xD;&#xA; долл США" />
        <view caption="Сумма" readonly="true">
          <template>
            <view caption="на {caption} год">
              <col width="150" name="USD_Y{fieldName}" align="right" displayFormat=",0.00000" caption="в иностранной валюте&#xD;&#xA;в  долл США" />
              <col width="150" name="Y{fieldName}" align="right" displayFormat=",0.00" caption="рублевый эквивалент по курсу долл США,&#xD;&#xA;в руб" />
            </view>
            <rules>
              <rule name="%Doc%.AddYearsHelper.GetYearsFieldRangeEventHandler" event="OnGetFieldsRange" />
              <rule name="%Doc%.CommonRules.GetYearsCaptionEventHandler" event="OnGetCaption" />
            </rules>
          </template>
        </view>
        <template>
          <view caption="Сумма, подлежащих исполнению за пределами планового периода" readonly="true">
            <col width="150" name="USD_Y{fieldName}" align="right" displayFormat=",0.00000" caption="в иностранной валюте&#xD;&#xA;в  долл США" />
            <col width="150" name="Y{fieldName}" align="right" displayFormat=",0.00" caption="рублевый эквивалент по курсу долл США,&#xD;&#xA;в  руб" />
          </view>
          <rules>
            <rule name="%Doc%.AddYearsHelper.GetAddYearsFieldRangeEventHandler" event="OnGetFieldsRange" />
          </rules>
        </template>
        <editors>
          <editor id="F04_120_R2_1_Editor" canAdd="true" />
        </editors>
      </view>
      <view table="dual" readonly="true">
        <editors>
          <editor id="F04_120_R2_1_Editor" canAdd="true" />
        </editors>
      </view>
      <rules>
        <rule name="%Doc%.P2Sp1Sheet.FormatEventHandler" event="OnGetFormat" />
        <rule name="%Doc%.P2Sp1Sheet.CalcEventHandler" event="OnCalc" />
        <rule name="ObasHelper.ConstraintYearEditCellHandler" event="OnEditCell" />
      </rules>
    </gridsheet>
    <gridsheet title="Раздел 2.2" name="SHT_F04_120_R2_2" exportable="false" caption="2.2. Расчет по направлениям инвестирования" isShowColumnNumbers="true">
      <view table="F04_120_R2_1" readonly="true">
        <col width="200" name="Name" align="left" readonly="true" isMergeCells="true" caption="Наименование объекта" />
        <view table="F04_120_R2_2" levelModifier="1" readonly="false">
          <col width="200" name="Investigation_ID" align="left" readonly="true" caption="Направление инвестирования" />
          <col width="50" name="StrCode" align="center" readonly="true" caption="Код строки" />
          <col width="150" name="OKEI_ID" align="left" readonly="true" caption="Наименование единицы измерения" />
          <col width="150" name="g6" align="right" displayFormat=",0.00" caption="Мощность" />
          <view caption="Сумма">
            <template>
              <view caption="на {caption} год">
                <col width="150" name="USD_Y{fieldName}" align="right" displayFormat=",0.00000" caption="в иностранной валюте&#xD;&#xA;в долл США" />
                <col width="150" name="Y{fieldName}" align="right" displayFormat=",0.00" readonly="true" caption="рублевый эквивалент по курсу долл США,&#xD;&#xA;в руб" />
              </view>
              <rules>
                <rule name="%Doc%.AddYearsHelper.GetYearsFieldRangeEventHandler" event="OnGetFieldsRange" />
                <rule name="%Doc%.CommonRules.GetYearsCaptionEventHandler" event="OnGetCaption" />
              </rules>
            </template>
          </view>
          <template>
            <view caption="Сумма, подлежащих исполнению за пределами планового периода">
              <col width="150" name="USD_Y{fieldName}" align="right" displayFormat=",0.00000" caption="в иностранной валюте&#xD;&#xA;в  долл США" />
              <col width="150" name="Y{fieldName}" align="right" displayFormat=",0.00" readonly="true" caption="рублевый эквивалент по курсу долл США,&#xD;&#xA;в  руб" />
            </view>
            <rules>
              <rule name="%Doc%.AddYearsHelper.GetAddYearsFieldRangeEventHandler" event="OnGetFieldsRange" />
            </rules>
          </template>
          <editors>
            <editor id="F04_120_R2_2_Editor" canAdd="true" />
          </editors>
        </view>
        <view table="dual" readonly="true">
          <editors>
            <editor id="F04_120_R2_2_Editor" canAdd="true" />
          </editors>
        </view>
        <editors>
          <editor id="F04_120_R2_2_Editor" canAdd="true" />
        </editors>
      </view>
      <view table="dual" readonly="true" />
      <rules>
        <rule name="%Doc%.P2Sp2Sheet.FormatEventHandler" event="OnGetFormat" />
        <rule name="%Doc%.P2Sp2Sheet.CalcEventHandler" event="OnCalc" />
        <rule name="%Doc%.P2Sp2Sheet.EditingCellEventHandler" event="OnEditingCell" />
        <rule name="%Doc%.P2Sp2Sheet.CanEditEventHandler" event="OnCanEdit" />
        <rule name="%Doc%.P2Sp2Sheet.CanEditEventHandler" event="OnCanDelete" />
      </rules>
    </gridsheet>
    <gridsheet title="Раздел 2.3" name="SHT_F04_120_R2_4" caption="2.3. Справочно: курс доллара США, учтенный при расчете, руб за 1 долл США" isShowColumnNumbers="true">
      <view table="tRateDollarActual" readonly="true">
        <template>
          <col width="100" name="Val{fieldName}" caption="на {caption} год" align="right" displayFormat=",0.00" />
          <rules>
            <rule name="%Doc%.AddYearsHelper.GetDollarRateYearsFieldRangeEventHandler" event="OnGetFieldsRange" />
            <rule name="%Doc%.CommonRules.GetYearsCaptionEventHandler" event="OnGetCaption" />
          </rules>
        </template>
        <template>
          <col width="150" name="Val{fieldName}" caption="за пределами планового периода" align="right" displayFormat=",0.00" />
          <rules>
            <rule name="%Doc%.AddYearsHelper.GetAddDollarRateYearsFieldRangeEventHandler" event="OnGetFieldsRange" />
          </rules>
        </template>
      </view>
      <rules>
        <rule name="%Doc%.CommonRules.GetDollarRateFormat" event="OnGetFormat" />
      </rules>
    </gridsheet>
    <rules>
      <rule name="%Doc%.CommonRules.GetExcelFileName" event="OnGetExportFileName" />
      <rule name="%Doc%.CommonRules.GetExcelTemplateFileName" event="OnGetTemplateFileName" />
      <rule name="%Doc%.UpdateRules.UpdateTemplate" event="OnUpdateTemplate" />
      <rule name="%Doc%.CommonRules.CheckChangeType" event="OnBeforeDocumentSave" />
      <rule name="%Doc%.CommonRules.KosguDocumentSaveEventHandler" event="OnDocumentSave" />
      <rule name="%Doc%.CommonRules.GetExportDirectory" event="OnGetDefaultExportDirectory" />
    </rules>
  </sheets>
  <menu>
    <menu caption="Сервис">
      <menu caption="Выполнить пересчет данных">
        <rules>
          <rule name="%Doc%.InterfaceRules.RecalcDataMenuItemClickEventHandler" event="OnClick" />
        </rules>
      </menu>
    </menu>
    <menu caption="Разработчик">
      <menu caption="Выполнить сдвиг данных">
        <rules>
          <rule name="%Doc%.InterfaceRules.ShiftDataMenuItemClickEventHandler" event="OnClick" />
        </rules>
      </menu>
      <menu caption="Выполнить копирование данных">
        <rules>
          <rule name="%Doc%.InterfaceRules.CopyDataMenuItemClickEventHandler" event="OnClick" />
        </rules>
      </menu>
    </menu>
  </menu>
  <editors>
    <editor id="F04_120_R2_1_Editor" caption="Сведения об объекте государственной собственности">
      <fieldssheet title="Основная информация" name="F04_120_R2_1_Editor_1" table="F04_120_R2_1">
        <field name="Name" />
        <field name="City" />
        <field name="OKSM_ID" />
      </fieldssheet>
    </editor>
    <editor id="F04_120_R2_2_Editor" caption="Сведения о направлении инвестирования">
      <fieldssheet title="Основная информация" name="F04_120_R2_2_Editor_1" table="F04_120_R2_2">
        <field name="Investigation_ID" caption="Направление инвестирования" />
        <field name="OKEI_ID" caption="Наименование единицы измерения" />
        <field name="g6" caption="Мощность" />
      </fieldssheet>
    </editor>
  </editors>
  <files />
</document>